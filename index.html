<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Grade My Finance</title>
<style>
  /* THEME TOKENS */
  :root{
    --bg: #0f172a;          /* dark slate */
    --panel:#0b1226;
    --card:#0b1226;
    --text:#e2e8f0;
    --muted:#94a3b8;
    --line:rgba(148,163,184,.22);
    --accent:#22d3ee;       /* cyan */
    --accent2:#a78bfa;      /* violet */
    --good:#22c55e; --warn:#f59e0b; --bad:#ef4444;
    --radius:16px; --shadow:0 10px 30px rgba(0,0,0,.35);
  }
  .light{
    --bg:#f6f7fb;
    --panel:#ffffff;
    --card:#ffffff;
    --text:#0f172a;
    --muted:#657084;
    --line:rgba(15,23,42,.12);
    --shadow:0 8px 28px rgba(15,23,42,.08);
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg); color:var(--text);
    font-family: ui-sans-serif,system-ui,Inter,Segoe UI,Arial;
    line-height:1.3;
  }

  /* BANNER LOGO */
  .banner{
    position:sticky; top:0; z-index:10;
    background: linear-gradient(90deg, rgba(34,211,238,.18), rgba(167,139,250,.18));
    border-bottom:1px solid var(--line);
    backdrop-filter: blur(6px);
  }
  .wrap{max-width:1100px;margin:0 auto;padding:14px 16px}
  .logoWide{
    width:100%;
    height:96px;
    border-radius:14px;
    background:
      radial-gradient(600px 120px at 10% 0%, rgba(255,255,255,.25), transparent 60%),
      linear-gradient(90deg, var(--accent), var(--accent2));
    display:flex; align-items:center; justify-content:space-between;
    padding:0 18px; color:#0b1226; box-shadow:var(--shadow);
  }
  .logoWide h1{margin:0;font-size:30px;letter-spacing:.4px}
  .tag{font-size:13px;opacity:.85}
  .modeBtn{
    border:none; cursor:pointer; font-weight:800; letter-spacing:.2px;
    padding:10px 14px; border-radius:999px; background:#0b1226; color:#e2e8f0;
  }
  .light .modeBtn{background:#0f172a; color:#e2e8f0}

  /* LAYOUT */
  .grid{display:grid; grid-template-columns:repeat(12,1fr); gap:14px}
  .card{
    background:var(--card); border:1px solid var(--line);
    border-radius:var(--radius); padding:16px; box-shadow:var(--shadow);
  }
  .section{font-size:14px; margin:0 0 8px 0; color:var(--muted); font-weight:800}
  label{font-size:12px; color:var(--muted); display:block; margin-bottom:6px}
  input{
    width:100%; border:1px solid var(--line); border-radius:12px;
    padding:12px; background:var(--panel); color:var(--text); outline:none;
  }
  input:focus{border-color:var(--accent); box-shadow:0 0 0 3px rgba(34,211,238,.18)}

  .actions{display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end}
  .btn{
    padding:12px 16px; border-radius:12px; border:1px solid var(--line);
    background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02));
    color:var(--text); font-weight:800; cursor:pointer;
  }
  .btn.primary{
    background:linear-gradient(90deg, var(--accent), var(--accent2));
    border-color:transparent; color:#0b1226; text-shadow:0 1px 0 rgba(255,255,255,.35);
  }

  /* RESULT */
  .resultTitle{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
  .bigGrade{
    font-size:64px; font-weight:900; line-height:1; letter-spacing:.5px;
    opacity:0; transform:scale(.7) rotate(-8deg);
  }
  .bigGrade.show{animation:pop .65s cubic-bezier(.2,.9,.2,1) forwards}
  @keyframes pop{
    0%{opacity:0; transform:scale(.7) rotate(-8deg)}
    60%{opacity:1; transform:scale(1.08) rotate(2deg)}
    100%{opacity:1; transform:scale(1) rotate(0)}
  }
  .scoreline{font-size:14px; color:var(--muted)}
  .progress{height:10px;background:var(--panel);border:1px solid var(--line);
    border-radius:999px; overflow:hidden}
  .progress>div{height:100%;width:0%;background:linear-gradient(90deg,var(--accent),var(--accent2))}

  .chips{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
  .chip{padding:8px 12px;border-radius:999px;border:1px solid var(--line);font-size:12px}

  .grid2{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:12px}
  .note{border:1px dashed var(--line);border-radius:14px;padding:12px;background:rgba(255,255,255,.02)}
  .note h4{margin:0 0 6px 0}

  /* OVERLAY LOADER */
  .overlay{position:fixed;inset:0;display:none;place-items:center;background:rgba(0,0,0,.35);z-index:60}
  .overlay.show{display:grid}
  .box{width:420px;max-width:86vw;background:var(--panel);border:1px solid var(--line);border-radius:18px;padding:18px;box-shadow:var(--shadow)}
  .bar{height:12px;border-radius:999px;background:var(--card);border:1px solid var(--line);overflow:hidden}
  .bar>div{height:100%;width:6%;background:linear-gradient(90deg,var(--accent),var(--accent2));transition:width .25s}

  /* SMALL */
  @media (max-width:980px){
    .grid2{grid-template-columns:1fr}
  }
</style>
</head>
<body class="dark">
  <!-- Banner Logo -->
  <div class="banner">
    <div class="wrap">
      <div class="logoWide" role="img" aria-label="Grade My Finance banner">
        <div>
          <h1>🎯 Grade My Finance</h1>
          <div class="tag">A playful snapshot of your money health — learn, level-up, repeat.</div>
        </div>
        <button id="modeBtn" class="modeBtn" aria-label="Toggle light/dark">🌚 Dark</button>
      </div>
    </div>
  </div>

  <div class="wrap" style="margin-top:18px">
    <div class="grid">
      <!-- Inputs -->
      <div class="card" style="grid-column:span 4">
        <div class="section">Monthly Income (after-tax)</div>
        <label>What hits your bank each month</label>
        <input id="income" type="number" value="7500" min="0" />
      </div>
      <div class="card" style="grid-column:span 4">
        <div class="section">Monthly Expenses</div>
        <label>All bills + spending</label>
        <input id="expenses" type="number" value="4000" min="0" />
      </div>
      <div class="card" style="grid-column:span 4">
        <div class="section">Cash Savings</div>
        <label>Checking + savings + HSA</label>
        <input id="cash" type="number" value="25000" min="0" />
      </div>

      <div class="card" style="grid-column:span 6">
        <div class="section">Assets 💰</div>
        <div class="grid" style="grid-template-columns:repeat(12,1fr);gap:12px">
          <div style="grid-column:span 6"><label>Home Value</label><input id="home" type="number" value="450000" min="0"></div>
          <div style="grid-column:span 6"><label>Retirement (401k/IRA)</label><input id="retire" type="number" value="72000" min="0"></div>
          <div style="grid-column:span 6"><label>Brokerage/Stocks</label><input id="brokerage" type="number" value="29000" min="0"></div>
          <div style="grid-column:span 6"><label>Car Value</label><input id="car" type="number" value="17000" min="0"></div>
        </div>
        <div class="scoreline" id="assetsHint">Total Assets: —</div>
      </div>

      <div class="card" style="grid-column:span 6">
        <div class="section">Liabilities 🧾</div>
        <div class="grid" style="grid-template-columns:repeat(12,1fr);gap:12px">
          <div style="grid-column:span 6"><label>Mortgage Balance</label><input id="mortgage" type="number" value="326000" min="0"></div>
          <div style="grid-column:span 6"><label>Student Loans</label><input id="student" type="number" value="26000" min="0"></div>
          <div style="grid-column:span 6"><label>Auto Loans</label><input id="auto" type="number" value="13000" min="0"></div>
          <div style="grid-column:span 6"><label>Credit Cards (balance)</label><input id="cc" type="number" value="2200" min="0"></div>
        </div>
        <div class="scoreline" id="liabHint">Total Liabilities: —</div>
      </div>

      <div class="card" style="grid-column:span 8">
        <div class="section">About You</div>
        <div class="grid" style="grid-template-columns:repeat(12,1fr);gap:12px">
          <div style="grid-column:span 3"><label>Age</label><input id="age" type="number" value="29" min="16" max="100"></div>
          <div style="grid-column:span 9"><label>Nickname (optional)</label><input id="nick" placeholder="e.g., Money Maverick 😎"></div>
        </div>
      </div>

      <div class="card" style="grid-column:span 4;display:flex;align-items:end;justify-content:end">
        <div class="actions">
          <button id="resetBtn" class="btn">Reset</button>
          <button id="gradeBtn" class="btn primary">Grade Me 🎉</button>
        </div>
      </div>

      <!-- RESULT -->
      <div class="card" style="grid-column:span 12">
        <div class="resultTitle">
          <div id="bigGrade" class="bigGrade">—</div>
          <div>
            <div id="scoreLine" class="scoreline">Score: — / 100.0</div>
            <div id="nwLine" class="scoreline">Net worth: —</div>
            <div class="chips" id="chips"></div>
          </div>
        </div>

        <div style="margin:14px 0 8px 0" class="progress"><div id="progressFill"></div></div>

        <div class="grid2">
          <div class="note">
            <h4>What went into your grade 🧠</h4>
            <div id="whyList">Enter numbers and hit “Grade Me.”</div>
          </div>
          <div class="note">
            <h4>How to level up 📈</h4>
            <div id="improveList">Personalized ideas will show up here.</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- LOADER -->
  <div id="overlay" class="overlay" aria-live="polite" aria-busy="true">
    <div class="box">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <strong>Crunching numbers…</strong><span id="pct" class="scoreline">0%</span>
      </div>
      <div class="bar"><div id="barFill"></div></div>
    </div>
  </div>

<script>
/* ---------- Tiny helpers ---------- */
const $ = s => document.querySelector(s);
const money  = n => isFinite(n) ? `$${Math.round(n).toLocaleString()}` : '—';
const pctStr = n => (n*100).toFixed(0)+'%';
const clamp  = (x,a=0,b=1)=>Math.max(a,Math.min(b,x));
const map01  = (x,a,b)=>clamp((x-a)/(b-a));

/* ---------- Theme toggle ---------- */
const modeBtn = $('#modeBtn');
const setMode = (light)=>{ document.body.classList.toggle('light', light); modeBtn.textContent = light ? '🌞 Light' : '🌚 Dark'; }
let light = false; setMode(light);
modeBtn.onclick = ()=>{ light = !light; setMode(light); };

/* ---------- Read inputs + live totals ---------- */
const ids = ['income','expenses','cash','home','retire','brokerage','car','mortgage','student','auto','cc','age'];
const els = Object.fromEntries(ids.map(id=>[id,$('#'+id)]));
Object.values(els).forEach(el=> el.addEventListener('input', updateHints));
updateHints();

function updateHints(){
  const v = values();
  $('#assetsHint').textContent = `Total Assets: ${money(v.assets)}`;
  $('#liabHint').textContent   = `Total Liabilities: ${money(v.liabs)}`;
}
function values(){
  const v = Object.fromEntries(ids.map(id=>[id, Number(els[id].value||0)]));
  v.assets = v.cash + v.home + v.retire + v.brokerage + v.car;
  v.liabs  = v.mortgage + v.student + v.auto + v.cc;
  v.net    = v.assets - v.liabs;
  return v;
}

/* ---------- Scoring (0..100) ----------
   Goals: sensible, forgiving, and FUN.
   We cap/scale so extreme wealth scores well, and being lopsided shows up
   in the explanations + improvement tips.

   Weights:
   - Net-worth strength vs income (log-ish) ............. 30
   - Savings rate (monthly) ............................. 25
   - Emergency fund months .............................. 15
   - Leverage (Liabilities / Assets) .................... 15
   - Credit cards vs income ............................. 5
   - Invested share of assets ........................... 10
------------------------------------------------------- */
function scoreModel(v){
  const incY = v.income*12 || 1;
  const leftover = Math.max(0, v.income - v.expenses);
  const saveRate = v.income>0 ? leftover / v.income : 0;          // 0..1+
  const efMonths = v.expenses>0 ? v.cash / v.expenses : 0;        // months
  const leverage = v.assets>0 ? v.liabs / v.assets : 1;           // lower better
  const ccLoad   = v.income>0 ? v.cc / v.income : 1;              // lower better
  const investable = v.retire + v.brokerage;
  const investShare = v.assets>0 ? investable / v.assets : 0;

  // Net-worth strength relative to income (cap at 25x income; log-ish curve)
  const nwMultiple = v.net / incY;              // how many years of income
  const sNW   = map01(Math.log10(1 + Math.max(0, nwMultiple))*1.4, 0, Math.log10(1+25)*1.4);

  const sSave = map01(saveRate, 0, 0.6);        // 0 → 60%+
  const sEF   = map01(efMonths, 0, 12);         // 0 → 12+ months
  const sLev  = map01(1-leverage, 0, 1);        // 1.0 when no debt
  const sCC   = map01(1-ccLoad, 0, 1);
  const sInv  = map01(investShare, 0.15, 0.6);  // 15% → 60%+ of assets invested

  const score =
      30*sNW + 25*sSave + 15*sEF + 15*sLev + 5*sCC + 10*sInv;

  return {
    score: Number(score.toFixed(1)),
    saveRate, efMonths, leverage, ccLoad, investShare,
    nwMultiple
  };
}

/* ---------- Letter grade ---------- */
function letter(score){
  if(score>=97) return "A+";
  if(score>=93) return "A";
  if(score>=90) return "A-";
  if(score>=87) return "B+";
  if(score>=83) return "B";
  if(score>=80) return "B-";
  if(score>=77) return "C+";
  if(score>=73) return "C";
  if(score>=70) return "C-";
  if(score>=67) return "D+";
  if(score>=63) return "D";
  if(score>=60) return "D-";
  return "F";
}
function gradeColor(L){
  const map = {
    'A+':'var(--good)','A':'var(--good)','A-':'var(--good)',
    'B+':'#86efac','B':'#86efac','B-':'#86efac',
    'C+':'var(--warn)','C':'var(--warn)','C-':'var(--warn)',
    'D+':'#f97316','D':'#f97316','D-':'#f97316','F':'var(--bad)'
  }; return map[L]||'var(--text)';
}

/* ---------- Loader (never stuck) ---------- */
let barTimer=null;
function showOverlay(){
  const o=$('#overlay'); const bar=$('#barFill'); const pct=$('#pct');
  o.classList.add('show'); let p=6; bar.style.width=p+'%'; pct.textContent='6%';
  barTimer=setInterval(()=>{ p=Math.min(96, p+Math.random()*7); bar.style.width=p+'%'; pct.textContent=Math.round(p)+'%'; },220);
}
function hideOverlay(){
  clearInterval(barTimer);
  $('#barFill').style.width='100%'; $('#pct').textContent='100%';
  setTimeout(()=>$('#overlay').classList.remove('show'),240);
}

/* ---------- Explain + Improve ---------- */
function renderWhy(v,s){
  const chips = [];
  chips.push(`<span class="chip">Savings rate: <b>${(s.saveRate*100).toFixed(0)}%</b></span>`);
  chips.push(`<span class="chip">Emergency fund: <b>${s.efMonths.toFixed(1)} mo</b></span>`);
  chips.push(`<span class="chip">Leverage: <b>${(s.leverage*100).toFixed(0)}% of assets</b></span>`);
  chips.push(`<span class="chip">CC vs income: <b>${(s.ccLoad*100).toFixed(0)}%</b></span>`);
  chips.push(`<span class="chip">Invested share: <b>${(s.investShare*100).toFixed(0)}%</b></span>`);
  chips.push(`<span class="chip">NW ≈ <b>${s.nwMultiple.toFixed(1)}x</b> yearly income</span>`);
  $('#chips').innerHTML = chips.join('');

  const bullets = [];
  bullets.push(`• Your net worth is <b>${money(v.net)}</b> (assets ${money(v.assets)} minus liabilities ${money(v.liabs)}).`);
  bullets.push(`• Savings rate is <b>${(s.saveRate*100).toFixed(0)}%</b> — that’s about ${money(Math.max(0, v.income-v.expenses))}/mo kept.`);
  bullets.push(`• You’ve got <b>${s.efMonths.toFixed(1)} months</b> of emergency cash.`);
  bullets.push(`• Overall leverage is <b>${(s.leverage*100).toFixed(0)}%</b> of assets.`);
  bullets.push(`• Invested share of assets is <b>${(s.investShare*100).toFixed(0)}%</b> (retirement + brokerage).`);
  $('#whyList').innerHTML = bullets.map(b=>`<div>${b}</div>`).join('');
}

function renderImprove(v,s){
  const ideas=[];
  if(s.saveRate < 0.2) ideas.push(`Bump savings to <b>20%+</b> by trimming ${money(Math.ceil(v.income*0.05))}/mo and sending it to savings/investing.`);
  if(s.efMonths < 3) ideas.push(`Build an emergency fund to <b>3–6 months</b> (${money(v.expenses*3)}–${money(v.expenses*6)}).`);
  if(s.leverage > 0.5) ideas.push(`Pay down high-interest debts to lower leverage (<b>${(s.leverage*100).toFixed(0)}%</b> → target <b><50%</b>).`);
  if(s.ccLoad > 0.2) ideas.push(`Drop credit card balance below <b>20% of monthly income</b> (now ${(s.ccLoad*100).toFixed(0)}%).`);
  if(s.investShare < 0.35) ideas.push(`Increase invested share of assets to <b>35–60%+</b> over time (more into 401(k)/IRA/brokerage).`);
  if(s.nwMultiple < 3 && v.age >= 25) ideas.push(`Aim for net worth ≈ <b>3–5× income</b> next, you’re at <b>${s.nwMultiple.toFixed(1)}×</b>.`);
  if(!ideas.length) ideas.push(`You’re cruising! Keep automating contributions and reviewing yearly. 🎉`);
  $('#improveList').innerHTML = ideas.map(x=>`<div>• ${x}</div>`).join('');
}

/* ---------- Grade flow ---------- */
const bigGrade = $('#bigGrade');
const scoreLine= $('#scoreLine');
const nwLine   = $('#nwLine');
const progress = $('#progressFill');

$('#gradeBtn').onclick = async ()=>{
  bigGrade.classList.remove('show');
  showOverlay();
  try{
    await new Promise(r=>setTimeout(r,650)); // polish delay
    const v = values();
    const s = scoreModel(v);

    const L = letter(s.score);
    bigGrade.textContent = L;
    bigGrade.style.color = gradeColor(L);
    requestAnimationFrame(()=>bigGrade.classList.add('show'));

    scoreLine.textContent = `Score: ${s.score.toFixed(1)} / 100.0`;
    nwLine.textContent = `Net worth: ${money(v.net)} • Assets: ${money(v.assets)} • Liabilities: ${money(v.liabs)}`;
    progress.style.width = s.score+'%';

    renderWhy(v,s);
    renderImprove(v,s);
  } finally {
    hideOverlay();
  }
};

$('#resetBtn').onclick = ()=>{
  document.querySelectorAll('input[type="number"]').forEach(el=>el.value=0);
  els.age.value = 30;
  updateHints();
  bigGrade.textContent='—'; bigGrade.classList.remove('show');
  scoreLine.textContent='Score: — / 100.0'; nwLine.textContent='Net worth: —';
  progress.style.width='0%'; $('#chips').innerHTML=''; $('#whyList').textContent=''; $('#improveList').textContent='';
};
</script>
</body>
</html>
